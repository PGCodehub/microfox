# Martian: Markdown to Notion Parser

Convert Markdown and GitHub Flavoured Markdown to Notion API Blocks and RichText.

[![Node.js CI](https://github.com/tryfabric/martian/actions/workflows/ci.yml/badge.svg)](https://github.com/tryfabric/martian/actions/workflows/ci.yml)
[![Code Style: Google](https://img.shields.io/badge/code%20style-google-blueviolet.svg)](https://github.com/google/gts)

Martian is a Markdown parser to convert any Markdown content to Notion API block or RichText objects. It
uses [unified](https://github.com/unifiedjs/unified) to create a Markdown AST, then converts the AST into Notion
objects.

Designed to make using the Notion SDK and API easier. Notion API version 1.0.

### Working with AI-Generated Content

When working with AI-generated content that needs to be posted to Notion, you can use the `markdownToBlocks` function to convert markdown content into Notion blocks. This is particularly useful when you're using AI providers to generate content and want to maintain proper formatting in Notion.

Here's an example of how to use it with AI-generated content:

```typescript
import { markdownToBlocks } from '@tryfabric/martian';
import { Client as NotionClient } from '@microfox/notion';

// Initialize Notion client
const notion = new NotionClient({
  auth: process.env.NOTION_ACCESS_TOKEN,
});

// Example function to create a page with AI-generated content
async function createNotionPageWithAIContent(title: string, markdownContent: string) {
  const notionBlocks = markdownToBlocks(markdownContent);
  
  const response = await notion.pages.create({
    parent: { database_id: process.env.NOTION_DATABASE_ID },
    properties: {
      Name: {
        type: "title",
        title: [{ type: "text", text: { content: title } }]
      }
    },
    children: notionBlocks // The converted markdown content
  });

  return response;
}

// Usage example with AI-generated content
const aiGeneratedMarkdown = `
# My AI Generated Article

## Introduction
This is an AI-generated article about...

### Key Points
- Point 1
- Point 2

> ðŸ“˜ **Important Note:** This content was generated by AI
`;

const page = await createNotionPageWithAIContent(
  "AI Generated Article",
  aiGeneratedMarkdown
);
```

This approach ensures that your AI-generated content maintains proper formatting, headers, lists, and other markdown elements when displayed in Notion.

### Supported Markdown Elements

- All inline elements (italics, bold, strikethrough, inline code, hyperlinks, equations)
- Lists (ordered, unordered, checkboxes) - to any level of depth
- All headers (header levels >= 3 are treated as header level 3)
- Code blocks, with language highlighting support
- Block quotes
  - Supports GFM alerts (e.g. [!NOTE], [!TIP], [!IMPORTANT], [!WARNING], [!CAUTION])
  - Supports Notion callouts when blockquote starts with an emoji (optional, enabled with `enableEmojiCallouts`)
  - Automatically maps common emojis and alert types to appropriate background colors
  - Preserves formatting and nested blocks within callouts
- Tables
- Equations
- Images
  - Inline images are extracted from the paragraph and added afterwards (as these are not supported in notion)
  - Image urls are validated, if they are not valid as per the Notion external spec, they will be inserted as text for you to fix manually

[Rest of the original documentation...]